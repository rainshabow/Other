(vscode) D:\Code\Github\Other\Python\DBN手写数字识别>python src\model\train.py --layers 784,1000,500,250 --pretrain_epochs 50 --pretrain_lr 0.01 --epochs 100 --lr 0.001 --batch_size 256
Using bundled font for Chinese labels: Microsoft YaHei
Stage: Loading MNIST dataset...
Stage: Initializing DBN with layer sizes: [784, 1000, 500, 250]
Stage: Pretraining RBMs...
Pretraining RBM 0: 784->1000
 RBM 0 epoch 1/50 loss=0.154902
 RBM 0 epoch 2/50 loss=0.124918
 RBM 0 epoch 3/50 loss=0.106284
 RBM 0 epoch 4/50 loss=0.097204
 RBM 0 epoch 5/50 loss=0.090866
 RBM 0 epoch 6/50 loss=0.085810
 RBM 0 epoch 7/50 loss=0.081683
 RBM 0 epoch 8/50 loss=0.078285
 RBM 0 epoch 9/50 loss=0.075366
 RBM 0 epoch 10/50 loss=0.072848
 RBM 0 epoch 11/50 loss=0.070678
 RBM 0 epoch 12/50 loss=0.068763
 RBM 0 epoch 13/50 loss=0.067030
 RBM 0 epoch 14/50 loss=0.065570
 RBM 0 epoch 15/50 loss=0.064186
 RBM 0 epoch 16/50 loss=0.062881
 RBM 0 epoch 17/50 loss=0.061754
 RBM 0 epoch 18/50 loss=0.060718
 RBM 0 epoch 19/50 loss=0.059722
 RBM 0 epoch 20/50 loss=0.058857
 RBM 0 epoch 21/50 loss=0.058010
 RBM 0 epoch 22/50 loss=0.057299
 RBM 0 epoch 23/50 loss=0.056562
 RBM 0 epoch 24/50 loss=0.055916
 RBM 0 epoch 25/50 loss=0.055308
 RBM 0 epoch 26/50 loss=0.054724
 RBM 0 epoch 27/50 loss=0.054191
 RBM 0 epoch 28/50 loss=0.053709
 RBM 0 epoch 29/50 loss=0.053210
 RBM 0 epoch 30/50 loss=0.052778
 RBM 0 epoch 31/50 loss=0.052328
 RBM 0 epoch 32/50 loss=0.051899
 RBM 0 epoch 33/50 loss=0.051529
 RBM 0 epoch 34/50 loss=0.051116
 RBM 0 epoch 35/50 loss=0.050749
 RBM 0 epoch 36/50 loss=0.050461
 RBM 0 epoch 37/50 loss=0.050102
 RBM 0 epoch 38/50 loss=0.049805
 RBM 0 epoch 39/50 loss=0.049515
 RBM 0 epoch 40/50 loss=0.049274
 RBM 0 epoch 41/50 loss=0.048952
 RBM 0 epoch 42/50 loss=0.048710
 RBM 0 epoch 43/50 loss=0.048455
 RBM 0 epoch 44/50 loss=0.048243
 RBM 0 epoch 45/50 loss=0.047946
 RBM 0 epoch 46/50 loss=0.047772
 RBM 0 epoch 47/50 loss=0.047523
 RBM 0 epoch 48/50 loss=0.047351
 RBM 0 epoch 49/50 loss=0.047114
 RBM 0 epoch 50/50 loss=0.046919
Pretraining RBM 1: 1000->500
 RBM 1 epoch 1/50 loss=0.237385
 RBM 1 epoch 2/50 loss=0.205725
 RBM 1 epoch 3/50 loss=0.188280
 RBM 1 epoch 4/50 loss=0.179580
 RBM 1 epoch 5/50 loss=0.173494
 RBM 1 epoch 6/50 loss=0.168699
 RBM 1 epoch 7/50 loss=0.164871
 RBM 1 epoch 8/50 loss=0.161877
 RBM 1 epoch 9/50 loss=0.159323
 RBM 1 epoch 10/50 loss=0.157160
 RBM 1 epoch 11/50 loss=0.155436
 RBM 1 epoch 12/50 loss=0.153895
 RBM 1 epoch 13/50 loss=0.152663
 RBM 1 epoch 14/50 loss=0.151613
 RBM 1 epoch 15/50 loss=0.150651
 RBM 1 epoch 16/50 loss=0.149777
 RBM 1 epoch 17/50 loss=0.149046
 RBM 1 epoch 18/50 loss=0.148364
 RBM 1 epoch 19/50 loss=0.147778
 RBM 1 epoch 20/50 loss=0.147244
 RBM 1 epoch 21/50 loss=0.146828
 RBM 1 epoch 22/50 loss=0.146362
 RBM 1 epoch 23/50 loss=0.146001
 RBM 1 epoch 24/50 loss=0.145689
 RBM 1 epoch 25/50 loss=0.145349
 RBM 1 epoch 26/50 loss=0.145115
 RBM 1 epoch 27/50 loss=0.144820
 RBM 1 epoch 28/50 loss=0.144601
 RBM 1 epoch 29/50 loss=0.144413
 RBM 1 epoch 30/50 loss=0.144213
 RBM 1 epoch 31/50 loss=0.143982
 RBM 1 epoch 32/50 loss=0.143841
 RBM 1 epoch 33/50 loss=0.143718
 RBM 1 epoch 34/50 loss=0.143618
 RBM 1 epoch 35/50 loss=0.143428
 RBM 1 epoch 36/50 loss=0.143328
 RBM 1 epoch 37/50 loss=0.143181
 RBM 1 epoch 38/50 loss=0.143069
 RBM 1 epoch 39/50 loss=0.142966
 RBM 1 epoch 40/50 loss=0.142871
 RBM 1 epoch 41/50 loss=0.142806
 RBM 1 epoch 42/50 loss=0.142719
 RBM 1 epoch 43/50 loss=0.142606
 RBM 1 epoch 44/50 loss=0.142536
 RBM 1 epoch 45/50 loss=0.142480
 RBM 1 epoch 46/50 loss=0.142366
 RBM 1 epoch 47/50 loss=0.142287
 RBM 1 epoch 48/50 loss=0.142239
 RBM 1 epoch 49/50 loss=0.142175
 RBM 1 epoch 50/50 loss=0.142069
Pretraining RBM 2: 500->250
 RBM 2 epoch 1/50 loss=0.249135
 RBM 2 epoch 2/50 loss=0.220274
 RBM 2 epoch 3/50 loss=0.191342
 RBM 2 epoch 4/50 loss=0.171024
 RBM 2 epoch 5/50 loss=0.158549
 RBM 2 epoch 6/50 loss=0.150692
 RBM 2 epoch 7/50 loss=0.144741
 RBM 2 epoch 8/50 loss=0.139735
 RBM 2 epoch 9/50 loss=0.135594
 RBM 2 epoch 10/50 loss=0.131988
 RBM 2 epoch 11/50 loss=0.128841
 RBM 2 epoch 12/50 loss=0.126042
 RBM 2 epoch 13/50 loss=0.123585
 RBM 2 epoch 14/50 loss=0.121315
 RBM 2 epoch 15/50 loss=0.119348
 RBM 2 epoch 16/50 loss=0.117601
 RBM 2 epoch 17/50 loss=0.116013
 RBM 2 epoch 18/50 loss=0.114640
 RBM 2 epoch 19/50 loss=0.113296
 RBM 2 epoch 20/50 loss=0.112109
 RBM 2 epoch 21/50 loss=0.111035
 RBM 2 epoch 22/50 loss=0.110108
 RBM 2 epoch 23/50 loss=0.109202
 RBM 2 epoch 24/50 loss=0.108348
 RBM 2 epoch 25/50 loss=0.107575
 RBM 2 epoch 26/50 loss=0.106895
 RBM 2 epoch 27/50 loss=0.106212
 RBM 2 epoch 28/50 loss=0.105538
 RBM 2 epoch 29/50 loss=0.104995
 RBM 2 epoch 30/50 loss=0.104481
 RBM 2 epoch 31/50 loss=0.103939
 RBM 2 epoch 32/50 loss=0.103401
 RBM 2 epoch 33/50 loss=0.103062
 RBM 2 epoch 34/50 loss=0.102570
 RBM 2 epoch 35/50 loss=0.102213
 RBM 2 epoch 36/50 loss=0.101808
 RBM 2 epoch 37/50 loss=0.101448
 RBM 2 epoch 38/50 loss=0.101019
 RBM 2 epoch 39/50 loss=0.100769
 RBM 2 epoch 40/50 loss=0.100454
 RBM 2 epoch 41/50 loss=0.100195
 RBM 2 epoch 42/50 loss=0.099907
 RBM 2 epoch 43/50 loss=0.099624
 RBM 2 epoch 44/50 loss=0.099359
 RBM 2 epoch 45/50 loss=0.099197
 RBM 2 epoch 46/50 loss=0.098906
 RBM 2 epoch 47/50 loss=0.098748
 RBM 2 epoch 48/50 loss=0.098473
 RBM 2 epoch 49/50 loss=0.098250
 RBM 2 epoch 50/50 loss=0.098088
Stage: Transferring RBM weights to classifier initialization...
Stage: Fine-tuning classifier...
Stage: Fine-tune epoch 1/100 loss=0.515765
 Test accuracy: 96.28%
Per-class accuracy:
  0: 98.88%  (n=980)
  1: 98.68%  (n=1135)
  2: 95.45%  (n=1032)
  3: 96.04%  (n=1010)
  4: 97.66%  (n=982)
  5: 96.08%  (n=892)
  6: 96.24%  (n=958)
  7: 95.14%  (n=1028)
  8: 95.48%  (n=974)
  9: 92.96%  (n=1009)
Top confusions (true -> predicted counts):
  9 -> 4: 33
  7 -> 9: 18
  7 -> 2: 13
  3 -> 5: 13
  8 -> 3: 12
  5 -> 3: 12
  9 -> 7: 11
  5 -> 8: 11
  6 -> 0: 10
  2 -> 8: 10
Stage: Fine-tune epoch 2/100 loss=0.089167
 Test accuracy: 97.11%
Per-class accuracy:
  0: 98.98%  (n=980)
  1: 99.03%  (n=1135)
  2: 96.71%  (n=1032)
  3: 97.62%  (n=1010)
  4: 96.23%  (n=982)
  5: 96.64%  (n=892)
  6: 96.87%  (n=958)
  7: 97.67%  (n=1028)
  8: 97.13%  (n=974)
  9: 93.95%  (n=1009)
Top confusions (true -> predicted counts):
  4 -> 9: 22
  9 -> 3: 16
  9 -> 7: 14
  2 -> 7: 13
  9 -> 8: 12
  5 -> 3: 12
  8 -> 3: 9
  6 -> 5: 9
  5 -> 8: 9
  9 -> 4: 8
Stage: Fine-tune epoch 3/100 loss=0.052046
 Test accuracy: 97.67%
Per-class accuracy:
  0: 99.08%  (n=980)
  1: 98.68%  (n=1135)
  2: 96.61%  (n=1032)
  3: 98.22%  (n=1010)
  4: 98.88%  (n=982)
  5: 97.87%  (n=892)
  6: 97.60%  (n=958)
  7: 97.37%  (n=1028)
  8: 97.54%  (n=974)
  9: 94.85%  (n=1009)
Top confusions (true -> predicted counts):
  9 -> 4: 17
  9 -> 7: 11
  2 -> 8: 11
  7 -> 9: 9
  2 -> 3: 8
  1 -> 8: 8
  9 -> 3: 7
  7 -> 2: 7
  6 -> 5: 7
  3 -> 5: 7
Stage: Fine-tune epoch 4/100 loss=0.032305
 Test accuracy: 98.03%
Per-class accuracy:
  0: 98.88%  (n=980)
  1: 99.30%  (n=1135)
  2: 97.77%  (n=1032)
  3: 98.22%  (n=1010)
  4: 97.76%  (n=982)
  5: 97.87%  (n=892)
  6: 98.23%  (n=958)
  7: 97.08%  (n=1028)
  8: 97.43%  (n=974)
  9: 97.62%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 9: 15
  4 -> 9: 12
  8 -> 9: 7
  7 -> 2: 7
  2 -> 0: 7
  5 -> 3: 6
  3 -> 5: 6
  9 -> 4: 5
  8 -> 5: 5
  8 -> 3: 5
Stage: Fine-tune epoch 5/100 loss=0.019804
 Test accuracy: 97.91%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.30%  (n=1135)
  2: 97.29%  (n=1032)
  3: 98.71%  (n=1010)
  4: 98.27%  (n=982)
  5: 97.31%  (n=892)
  6: 96.76%  (n=958)
  7: 97.57%  (n=1028)
  8: 97.84%  (n=974)
  9: 96.43%  (n=1009)
Top confusions (true -> predicted counts):
  9 -> 3: 12
  5 -> 3: 12
  6 -> 4: 10
  9 -> 4: 9
  7 -> 9: 9
  4 -> 9: 9
  2 -> 8: 9
  6 -> 0: 8
  8 -> 3: 7
  2 -> 3: 7
Stage: Fine-tune epoch 6/100 loss=0.011480
 Test accuracy: 98.05%
Per-class accuracy:
  0: 98.98%  (n=980)
  1: 99.38%  (n=1135)
  2: 97.77%  (n=1032)
  3: 98.51%  (n=1010)
  4: 98.78%  (n=982)
  5: 96.86%  (n=892)
  6: 97.91%  (n=958)
  7: 97.86%  (n=1028)
  8: 96.61%  (n=974)
  9: 97.52%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 14
  8 -> 3: 12
  2 -> 8: 10
  7 -> 9: 9
  6 -> 0: 8
  9 -> 4: 7
  6 -> 5: 7
  8 -> 9: 6
  8 -> 5: 6
  7 -> 2: 6
Stage: Fine-tune epoch 7/100 loss=0.008687
 Test accuracy: 98.10%
Per-class accuracy:
  0: 99.08%  (n=980)
  1: 98.68%  (n=1135)
  2: 98.16%  (n=1032)
  3: 98.32%  (n=1010)
  4: 97.45%  (n=982)
  5: 97.53%  (n=892)
  6: 97.81%  (n=958)
  7: 97.37%  (n=1028)
  8: 98.36%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  4 -> 9: 15
  7 -> 9: 11
  5 -> 3: 10
  7 -> 2: 8
  2 -> 8: 7
  1 -> 8: 7
  9 -> 4: 6
  6 -> 8: 6
  6 -> 4: 6
  8 -> 9: 5
Stage: Fine-tune epoch 8/100 loss=0.008145
 Test accuracy: 98.10%
Per-class accuracy:
  0: 99.18%  (n=980)
  1: 99.12%  (n=1135)
  2: 97.09%  (n=1032)
  3: 98.22%  (n=1010)
  4: 98.17%  (n=982)
  5: 98.09%  (n=892)
  6: 98.64%  (n=958)
  7: 97.57%  (n=1028)
  8: 97.13%  (n=974)
  9: 97.72%  (n=1009)
Top confusions (true -> predicted counts):
  2 -> 3: 15
  7 -> 9: 10
  4 -> 9: 9
  8 -> 5: 8
  3 -> 5: 8
  9 -> 4: 7
  8 -> 3: 6
  7 -> 2: 6
  2 -> 8: 6
  8 -> 9: 5
Stage: Fine-tune epoch 9/100 loss=0.007170
 Test accuracy: 97.71%
Per-class accuracy:
  0: 98.98%  (n=980)
  1: 98.77%  (n=1135)
  2: 98.16%  (n=1032)
  3: 98.02%  (n=1010)
  4: 96.64%  (n=982)
  5: 95.29%  (n=892)
  6: 97.70%  (n=958)
  7: 98.54%  (n=1028)
  8: 98.36%  (n=974)
  9: 96.23%  (n=1009)
Top confusions (true -> predicted counts):
  4 -> 9: 23
  5 -> 3: 22
  9 -> 3: 13
  2 -> 8: 9
  9 -> 8: 7
  8 -> 3: 7
  6 -> 4: 7
  3 -> 2: 7
  9 -> 4: 6
  7 -> 2: 6
Stage: Fine-tune epoch 10/100 loss=0.012980
 Test accuracy: 98.07%
Per-class accuracy:
  0: 98.98%  (n=980)
  1: 98.68%  (n=1135)
  2: 97.97%  (n=1032)
  3: 98.81%  (n=1010)
  4: 97.56%  (n=982)
  5: 96.08%  (n=892)
  6: 99.16%  (n=958)
  7: 98.25%  (n=1028)
  8: 97.95%  (n=974)
  9: 97.03%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 19
  4 -> 6: 10
  9 -> 4: 9
  4 -> 9: 8
  9 -> 7: 7
  7 -> 9: 7
  2 -> 8: 7
  5 -> 6: 6
  7 -> 2: 5
  3 -> 7: 5
Stage: Fine-tune epoch 11/100 loss=0.009440
 Test accuracy: 97.96%
Per-class accuracy:
  0: 99.18%  (n=980)
  1: 99.47%  (n=1135)
  2: 97.67%  (n=1032)
  3: 98.42%  (n=1010)
  4: 97.05%  (n=982)
  5: 96.75%  (n=892)
  6: 98.54%  (n=958)
  7: 97.28%  (n=1028)
  8: 97.23%  (n=974)
  9: 97.72%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 16
  4 -> 9: 14
  8 -> 3: 10
  7 -> 9: 9
  2 -> 3: 8
  2 -> 0: 8
  9 -> 4: 7
  7 -> 3: 7
  4 -> 6: 7
  3 -> 2: 7
Stage: Fine-tune epoch 12/100 loss=0.007284
 Test accuracy: 98.23%
Per-class accuracy:
  0: 99.18%  (n=980)
  1: 99.38%  (n=1135)
  2: 98.84%  (n=1032)
  3: 97.72%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.43%  (n=892)
  6: 97.70%  (n=958)
  7: 97.08%  (n=1028)
  8: 97.64%  (n=974)
  9: 97.32%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 9: 14
  3 -> 5: 13
  9 -> 4: 11
  7 -> 2: 7
  6 -> 5: 7
  9 -> 3: 6
  8 -> 5: 5
  5 -> 3: 5
  8 -> 9: 4
  8 -> 4: 4
Stage: Fine-tune epoch 13/100 loss=0.010267
 Test accuracy: 97.35%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 98.85%  (n=1135)
  2: 94.77%  (n=1032)
  3: 98.81%  (n=1010)
  4: 93.99%  (n=982)
  5: 97.42%  (n=892)
  6: 98.33%  (n=958)
  7: 97.08%  (n=1028)
  8: 97.13%  (n=974)
  9: 97.62%  (n=1009)
Top confusions (true -> predicted counts):
  4 -> 9: 48
  2 -> 3: 29
  8 -> 3: 18
  7 -> 9: 14
  5 -> 3: 12
  2 -> 8: 12
  9 -> 3: 10
  2 -> 7: 8
  9 -> 7: 6
  7 -> 3: 6
Stage: Fine-tune epoch 14/100 loss=0.006459
 Test accuracy: 98.25%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.03%  (n=1135)
  2: 98.16%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.17%  (n=982)
  5: 96.86%  (n=892)
  6: 98.02%  (n=958)
  7: 97.96%  (n=1028)
  8: 98.46%  (n=974)
  9: 97.42%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 13
  9 -> 4: 11
  4 -> 9: 9
  7 -> 2: 8
  2 -> 8: 8
  6 -> 5: 7
  6 -> 0: 6
  7 -> 1: 5
  9 -> 3: 4
  8 -> 9: 4
Stage: Fine-tune epoch 15/100 loss=0.003829
 Test accuracy: 98.45%
Per-class accuracy:
  0: 99.18%  (n=980)
  1: 99.30%  (n=1135)
  2: 97.29%  (n=1032)
  3: 98.51%  (n=1010)
  4: 98.68%  (n=982)
  5: 97.98%  (n=892)
  6: 98.85%  (n=958)
  7: 97.57%  (n=1028)
  8: 98.46%  (n=974)
  9: 98.61%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 9: 15
  2 -> 8: 9
  5 -> 3: 8
  9 -> 4: 7
  2 -> 7: 7
  4 -> 9: 6
  8 -> 9: 5
  3 -> 5: 5
  2 -> 3: 5
  7 -> 2: 4
Stage: Fine-tune epoch 16/100 loss=0.002542
 Test accuracy: 98.42%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 97.67%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.88%  (n=982)
  5: 97.65%  (n=892)
  6: 98.64%  (n=958)
  7: 97.96%  (n=1028)
  8: 98.56%  (n=974)
  9: 97.32%  (n=1009)
Top confusions (true -> predicted counts):
  9 -> 4: 13
  5 -> 3: 9
  2 -> 8: 8
  7 -> 9: 7
  2 -> 7: 5
  8 -> 9: 4
  7 -> 2: 4
  7 -> 1: 4
  6 -> 0: 4
  4 -> 6: 4
Stage: Fine-tune epoch 17/100 loss=0.007486
 Test accuracy: 97.94%
Per-class accuracy:
  0: 97.96%  (n=980)
  1: 99.38%  (n=1135)
  2: 97.58%  (n=1032)
  3: 98.22%  (n=1010)
  4: 98.57%  (n=982)
  5: 95.18%  (n=892)
  6: 98.43%  (n=958)
  7: 97.67%  (n=1028)
  8: 98.05%  (n=974)
  9: 97.92%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 18
  3 -> 9: 10
  9 -> 4: 9
  7 -> 9: 9
  5 -> 6: 9
  7 -> 2: 7
  5 -> 9: 7
  2 -> 3: 7
  2 -> 1: 7
  0 -> 2: 7
Stage: Fine-tune epoch 18/100 loss=0.014608
 Test accuracy: 97.89%
Per-class accuracy:
  0: 99.08%  (n=980)
  1: 99.12%  (n=1135)
  2: 97.00%  (n=1032)
  3: 98.71%  (n=1010)
  4: 98.27%  (n=982)
  5: 95.18%  (n=892)
  6: 98.85%  (n=958)
  7: 98.15%  (n=1028)
  8: 97.95%  (n=974)
  9: 96.23%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 18
  5 -> 8: 10
  2 -> 3: 10
  9 -> 8: 9
  9 -> 4: 8
  8 -> 3: 7
  7 -> 2: 7
  5 -> 6: 7
  2 -> 8: 7
  2 -> 0: 6
Stage: Fine-tune epoch 19/100 loss=0.011934
 Test accuracy: 98.34%
Per-class accuracy:
  0: 99.49%  (n=980)
  1: 99.38%  (n=1135)
  2: 98.16%  (n=1032)
  3: 97.92%  (n=1010)
  4: 98.07%  (n=982)
  5: 98.21%  (n=892)
  6: 98.43%  (n=958)
  7: 98.93%  (n=1028)
  8: 97.13%  (n=974)
  9: 97.52%  (n=1009)
Top confusions (true -> predicted counts):
  9 -> 4: 9
  8 -> 5: 7
  4 -> 9: 7
  3 -> 2: 7
  2 -> 7: 7
  9 -> 7: 6
  8 -> 9: 6
  8 -> 3: 5
  6 -> 5: 5
  6 -> 0: 5
Stage: Fine-tune epoch 20/100 loss=0.001804
 Test accuracy: 98.40%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.12%  (n=1135)
  2: 98.45%  (n=1032)
  3: 97.43%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.77%  (n=892)
  6: 98.43%  (n=958)
  7: 98.44%  (n=1028)
  8: 98.15%  (n=974)
  9: 97.13%  (n=1009)
Top confusions (true -> predicted counts):
  9 -> 4: 14
  3 -> 5: 11
  9 -> 7: 5
  7 -> 9: 5
  7 -> 2: 5
  3 -> 7: 5
  2 -> 8: 5
  2 -> 7: 5
  8 -> 0: 4
  7 -> 8: 4
Stage: Fine-tune epoch 21/100 loss=0.001096
 Test accuracy: 98.39%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.74%  (n=1032)
  3: 97.92%  (n=1010)
  4: 98.98%  (n=982)
  5: 97.98%  (n=892)
  6: 98.64%  (n=958)
  7: 98.64%  (n=1028)
  8: 97.95%  (n=974)
  9: 96.33%  (n=1009)
Top confusions (true -> predicted counts):
  9 -> 4: 21
  5 -> 3: 7
  3 -> 2: 7
  8 -> 4: 6
  7 -> 4: 5
  7 -> 2: 5
  5 -> 8: 5
  3 -> 7: 5
  9 -> 7: 4
  8 -> 9: 4
Stage: Fine-tune epoch 22/100 loss=0.003647
 Test accuracy: 98.34%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.47%  (n=1135)
  2: 98.55%  (n=1032)
  3: 98.32%  (n=1010)
  4: 96.03%  (n=982)
  5: 97.98%  (n=892)
  6: 98.96%  (n=958)
  7: 98.54%  (n=1028)
  8: 98.25%  (n=974)
  9: 97.82%  (n=1009)
Top confusions (true -> predicted counts):
  4 -> 9: 27
  5 -> 3: 8
  9 -> 4: 7
  7 -> 2: 7
  2 -> 8: 6
  4 -> 6: 5
  9 -> 7: 4
  8 -> 3: 4
  4 -> 7: 4
  3 -> 9: 4
Stage: Fine-tune epoch 23/100 loss=0.006039
 Test accuracy: 98.09%
Per-class accuracy:
  0: 98.57%  (n=980)
  1: 99.47%  (n=1135)
  2: 98.35%  (n=1032)
  3: 97.92%  (n=1010)
  4: 98.78%  (n=982)
  5: 95.63%  (n=892)
  6: 98.85%  (n=958)
  7: 96.98%  (n=1028)
  8: 98.15%  (n=974)
  9: 97.82%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 17
  7 -> 9: 11
  9 -> 4: 10
  7 -> 2: 9
  5 -> 8: 8
  3 -> 8: 8
  8 -> 4: 7
  3 -> 2: 6
  2 -> 8: 6
  8 -> 9: 5
Stage: Fine-tune epoch 24/100 loss=0.010591
 Test accuracy: 98.35%
Per-class accuracy:
  0: 98.88%  (n=980)
  1: 99.65%  (n=1135)
  2: 97.77%  (n=1032)
  3: 97.62%  (n=1010)
  4: 98.78%  (n=982)
  5: 99.22%  (n=892)
  6: 98.64%  (n=958)
  7: 97.86%  (n=1028)
  8: 97.84%  (n=974)
  9: 97.22%  (n=1009)
Top confusions (true -> predicted counts):
  3 -> 5: 9
  9 -> 4: 8
  8 -> 6: 7
  2 -> 7: 7
  9 -> 5: 5
  7 -> 2: 5
  7 -> 1: 5
  4 -> 6: 5
  3 -> 9: 5
  2 -> 8: 5
Stage: Fine-tune epoch 25/100 loss=0.007977
 Test accuracy: 98.08%
Per-class accuracy:
  0: 98.88%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.32%  (n=1010)
  4: 97.66%  (n=982)
  5: 94.39%  (n=892)
  6: 98.96%  (n=958)
  7: 97.86%  (n=1028)
  8: 98.36%  (n=974)
  9: 97.82%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 8: 19
  5 -> 3: 14
  4 -> 9: 13
  5 -> 9: 8
  7 -> 2: 7
  7 -> 9: 6
  3 -> 7: 6
  9 -> 7: 5
  8 -> 7: 5
  4 -> 6: 5
Stage: Fine-tune epoch 26/100 loss=0.005564
 Test accuracy: 98.42%
Per-class accuracy:
  0: 99.08%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.55%  (n=1032)
  3: 97.52%  (n=1010)
  4: 98.57%  (n=982)
  5: 97.98%  (n=892)
  6: 98.85%  (n=958)
  7: 98.25%  (n=1028)
  8: 97.64%  (n=974)
  9: 98.32%  (n=1009)
Top confusions (true -> predicted counts):
  3 -> 5: 9
  9 -> 4: 8
  7 -> 9: 7
  3 -> 7: 6
  6 -> 0: 5
  4 -> 6: 5
  3 -> 9: 5
  8 -> 9: 4
  8 -> 6: 4
  8 -> 4: 4
Stage: Fine-tune epoch 27/100 loss=0.002924
 Test accuracy: 98.44%
Per-class accuracy:
  0: 99.18%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.35%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.47%  (n=982)
  5: 97.42%  (n=892)
  6: 98.75%  (n=958)
  7: 98.74%  (n=1028)
  8: 98.36%  (n=974)
  9: 96.83%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 13
  9 -> 4: 9
  9 -> 3: 6
  4 -> 6: 6
  9 -> 7: 5
  2 -> 8: 5
  9 -> 8: 4
  6 -> 0: 4
  4 -> 9: 4
  3 -> 7: 4
Stage: Fine-tune epoch 28/100 loss=0.002881
 Test accuracy: 98.11%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 97.97%  (n=1032)
  3: 98.22%  (n=1010)
  4: 96.95%  (n=982)
  5: 97.09%  (n=892)
  6: 98.12%  (n=958)
  7: 97.67%  (n=1028)
  8: 98.67%  (n=974)
  9: 97.62%  (n=1009)
Top confusions (true -> predicted counts):
  4 -> 9: 15
  5 -> 3: 8
  7 -> 2: 7
  6 -> 8: 7
  5 -> 6: 7
  2 -> 0: 7
  7 -> 9: 6
  3 -> 8: 6
  2 -> 8: 6
  9 -> 8: 5
Stage: Fine-tune epoch 29/100 loss=0.001859
 Test accuracy: 98.30%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.21%  (n=1135)
  2: 97.77%  (n=1032)
  3: 97.72%  (n=1010)
  4: 98.17%  (n=982)
  5: 98.43%  (n=892)
  6: 98.12%  (n=958)
  7: 98.44%  (n=1028)
  8: 98.25%  (n=974)
  9: 97.52%  (n=1009)
Top confusions (true -> predicted counts):
  9 -> 4: 10
  3 -> 5: 9
  5 -> 3: 8
  2 -> 0: 8
  4 -> 6: 6
  6 -> 4: 5
  3 -> 7: 5
  2 -> 8: 5
  2 -> 7: 5
  9 -> 8: 4
Stage: Fine-tune epoch 30/100 loss=0.002888
 Test accuracy: 98.32%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.47%  (n=1135)
  2: 98.26%  (n=1032)
  3: 98.32%  (n=1010)
  4: 97.45%  (n=982)
  5: 96.86%  (n=892)
  6: 98.96%  (n=958)
  7: 98.93%  (n=1028)
  8: 97.64%  (n=974)
  9: 97.72%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 15
  9 -> 7: 8
  4 -> 9: 8
  9 -> 4: 7
  2 -> 0: 7
  4 -> 7: 6
  3 -> 7: 6
  8 -> 9: 5
  7 -> 2: 5
  4 -> 6: 5
Stage: Fine-tune epoch 31/100 loss=0.014180
 Test accuracy: 97.69%
Per-class accuracy:
  0: 98.67%  (n=980)
  1: 99.38%  (n=1135)
  2: 97.19%  (n=1032)
  3: 98.61%  (n=1010)
  4: 98.27%  (n=982)
  5: 95.85%  (n=892)
  6: 98.23%  (n=958)
  7: 97.76%  (n=1028)
  8: 97.64%  (n=974)
  9: 94.95%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 24
  9 -> 4: 19
  9 -> 3: 10
  9 -> 7: 9
  7 -> 4: 9
  2 -> 8: 9
  0 -> 6: 9
  8 -> 2: 8
  8 -> 3: 7
  4 -> 6: 6
Stage: Fine-tune epoch 32/100 loss=0.007337
 Test accuracy: 98.11%
Per-class accuracy:
  0: 99.49%  (n=980)
  1: 99.47%  (n=1135)
  2: 98.45%  (n=1032)
  3: 99.11%  (n=1010)
  4: 97.96%  (n=982)
  5: 96.08%  (n=892)
  6: 97.29%  (n=958)
  7: 98.05%  (n=1028)
  8: 97.54%  (n=974)
  9: 97.22%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 26
  8 -> 3: 8
  6 -> 5: 8
  4 -> 9: 8
  6 -> 0: 7
  4 -> 6: 7
  9 -> 4: 6
  9 -> 3: 6
  8 -> 9: 6
  7 -> 1: 6
Stage: Fine-tune epoch 33/100 loss=0.005242
 Test accuracy: 98.36%
Per-class accuracy:
  0: 99.18%  (n=980)
  1: 99.47%  (n=1135)
  2: 98.74%  (n=1032)
  3: 97.43%  (n=1010)
  4: 98.17%  (n=982)
  5: 98.54%  (n=892)
  6: 98.54%  (n=958)
  7: 97.67%  (n=1028)
  8: 98.46%  (n=974)
  9: 97.32%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 13
  9 -> 4: 11
  4 -> 6: 9
  3 -> 9: 9
  3 -> 5: 8
  6 -> 0: 6
  3 -> 2: 5
  8 -> 9: 4
  7 -> 1: 4
  5 -> 3: 4
Stage: Fine-tune epoch 34/100 loss=0.004538
 Test accuracy: 98.42%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.47%  (n=1135)
  2: 98.26%  (n=1032)
  3: 98.32%  (n=1010)
  4: 98.68%  (n=982)
  5: 97.98%  (n=892)
  6: 98.23%  (n=958)
  7: 97.76%  (n=1028)
  8: 98.46%  (n=974)
  9: 97.52%  (n=1009)
Top confusions (true -> predicted counts):
  9 -> 4: 9
  7 -> 2: 9
  2 -> 8: 7
  5 -> 3: 6
  3 -> 5: 6
  9 -> 8: 5
  6 -> 4: 5
  5 -> 8: 5
  4 -> 6: 5
  9 -> 7: 4
Stage: Fine-tune epoch 35/100 loss=0.002368
 Test accuracy: 98.31%
Per-class accuracy:
  0: 99.18%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.64%  (n=1032)
  3: 98.42%  (n=1010)
  4: 96.03%  (n=982)
  5: 98.43%  (n=892)
  6: 97.49%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.36%  (n=974)
  9: 98.91%  (n=1009)
Top confusions (true -> predicted counts):
  4 -> 9: 28
  6 -> 5: 12
  7 -> 2: 7
  3 -> 5: 6
  2 -> 8: 6
  8 -> 9: 5
  6 -> 4: 5
  5 -> 8: 5
  5 -> 3: 5
  4 -> 6: 5
Stage: Fine-tune epoch 36/100 loss=0.004223
 Test accuracy: 98.28%
Per-class accuracy:
  0: 98.98%  (n=980)
  1: 99.38%  (n=1135)
  2: 98.16%  (n=1032)
  3: 98.61%  (n=1010)
  4: 96.74%  (n=982)
  5: 97.98%  (n=892)
  6: 98.43%  (n=958)
  7: 98.25%  (n=1028)
  8: 98.15%  (n=974)
  9: 97.92%  (n=1009)
Top confusions (true -> predicted counts):
  4 -> 9: 22
  5 -> 3: 10
  7 -> 2: 6
  4 -> 6: 6
  2 -> 7: 6
  8 -> 9: 5
  2 -> 8: 5
  9 -> 5: 4
  9 -> 4: 4
  8 -> 4: 4
Stage: Fine-tune epoch 37/100 loss=0.003598
 Test accuracy: 98.39%
Per-class accuracy:
  0: 99.49%  (n=980)
  1: 98.94%  (n=1135)
  2: 98.55%  (n=1032)
  3: 98.51%  (n=1010)
  4: 97.56%  (n=982)
  5: 98.21%  (n=892)
  6: 98.23%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.46%  (n=974)
  9: 97.82%  (n=1009)
Top confusions (true -> predicted counts):
  4 -> 9: 15
  5 -> 3: 8
  7 -> 2: 7
  4 -> 6: 6
  3 -> 5: 6
  6 -> 5: 5
  6 -> 0: 5
  2 -> 8: 5
  9 -> 7: 4
  9 -> 5: 4
Stage: Fine-tune epoch 38/100 loss=0.000657
 Test accuracy: 98.44%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.45%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.57%  (n=982)
  5: 97.76%  (n=892)
  6: 98.64%  (n=958)
  7: 97.86%  (n=1028)
  8: 97.33%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 12
  7 -> 2: 8
  8 -> 4: 6
  8 -> 3: 6
  4 -> 9: 6
  9 -> 4: 5
  7 -> 1: 5
  4 -> 6: 5
  3 -> 5: 5
  2 -> 7: 5
Stage: Fine-tune epoch 39/100 loss=0.001013
 Test accuracy: 98.31%
Per-class accuracy:
  0: 99.49%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.35%  (n=1032)
  3: 98.42%  (n=1010)
  4: 97.86%  (n=982)
  5: 97.76%  (n=892)
  6: 98.85%  (n=958)
  7: 97.57%  (n=1028)
  8: 97.74%  (n=974)
  9: 97.62%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 12
  7 -> 9: 7
  7 -> 2: 7
  4 -> 9: 7
  4 -> 6: 7
  8 -> 3: 6
  7 -> 1: 6
  2 -> 7: 6
  9 -> 7: 5
  9 -> 4: 5
Stage: Fine-tune epoch 40/100 loss=0.000855
 Test accuracy: 98.43%
Per-class accuracy:
  0: 99.49%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.55%  (n=1032)
  3: 98.32%  (n=1010)
  4: 97.96%  (n=982)
  5: 98.09%  (n=892)
  6: 98.75%  (n=958)
  7: 98.35%  (n=1028)
  8: 97.84%  (n=974)
  9: 97.62%  (n=1009)
Top confusions (true -> predicted counts):
  4 -> 9: 9
  5 -> 3: 8
  9 -> 7: 6
  9 -> 4: 6
  8 -> 9: 6
  4 -> 6: 6
  3 -> 7: 6
  3 -> 5: 6
  7 -> 2: 5
  2 -> 7: 5
Stage: Fine-tune epoch 41/100 loss=0.001457
 Test accuracy: 98.30%
Per-class accuracy:
  0: 99.59%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.26%  (n=1032)
  3: 98.32%  (n=1010)
  4: 98.37%  (n=982)
  5: 98.32%  (n=892)
  6: 98.54%  (n=958)
  7: 98.44%  (n=1028)
  8: 96.82%  (n=974)
  9: 96.93%  (n=1009)
Top confusions (true -> predicted counts):
  9 -> 4: 10
  5 -> 3: 8
  9 -> 7: 7
  8 -> 0: 7
  8 -> 9: 6
  8 -> 3: 6
  3 -> 7: 6
  2 -> 7: 6
  7 -> 2: 5
  6 -> 0: 5
Stage: Fine-tune epoch 42/100 loss=0.007439
 Test accuracy: 97.73%
Per-class accuracy:
  0: 99.18%  (n=980)
  1: 98.94%  (n=1135)
  2: 97.38%  (n=1032)
  3: 98.51%  (n=1010)
  4: 98.37%  (n=982)
  5: 97.53%  (n=892)
  6: 97.39%  (n=958)
  7: 97.28%  (n=1028)
  8: 96.41%  (n=974)
  9: 96.13%  (n=1009)
Top confusions (true -> predicted counts):
  8 -> 3: 16
  5 -> 3: 15
  9 -> 4: 11
  2 -> 3: 11
  7 -> 2: 10
  6 -> 0: 8
  2 -> 8: 8
  9 -> 7: 7
  9 -> 5: 7
  7 -> 9: 7
Stage: Fine-tune epoch 43/100 loss=0.018781
 Test accuracy: 98.02%
Per-class accuracy:
  0: 98.98%  (n=980)
  1: 99.21%  (n=1135)
  2: 97.97%  (n=1032)
  3: 98.02%  (n=1010)
  4: 97.15%  (n=982)
  5: 97.42%  (n=892)
  6: 97.81%  (n=958)
  7: 98.44%  (n=1028)
  8: 97.54%  (n=974)
  9: 97.42%  (n=1009)
Top confusions (true -> predicted counts):
  4 -> 9: 17
  5 -> 3: 14
  3 -> 2: 11
  9 -> 7: 9
  7 -> 2: 8
  6 -> 5: 7
  8 -> 3: 6
  4 -> 6: 6
  2 -> 0: 6
  9 -> 5: 5
Stage: Fine-tune epoch 44/100 loss=0.007022
 Test accuracy: 98.23%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 98.59%  (n=1135)
  2: 98.26%  (n=1032)
  3: 98.22%  (n=1010)
  4: 97.76%  (n=982)
  5: 97.53%  (n=892)
  6: 98.23%  (n=958)
  7: 97.67%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  4 -> 9: 12
  7 -> 9: 9
  5 -> 3: 8
  4 -> 6: 7
  7 -> 2: 6
  5 -> 8: 5
  3 -> 8: 5
  3 -> 2: 5
  1 -> 8: 5
  8 -> 9: 4
Stage: Fine-tune epoch 45/100 loss=0.002213
 Test accuracy: 98.40%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.51%  (n=1010)
  4: 98.47%  (n=982)
  5: 97.09%  (n=892)
  6: 98.64%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.46%  (n=974)
  9: 97.13%  (n=1009)
Top confusions (true -> predicted counts):
  5 -> 3: 10
  7 -> 2: 8
  9 -> 8: 7
  9 -> 4: 6
  5 -> 6: 5
  4 -> 9: 5
  4 -> 6: 5
  9 -> 7: 4
  8 -> 9: 4
  7 -> 9: 4
Stage: Fine-tune epoch 46/100 loss=0.000517
 Test accuracy: 98.55%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.71%  (n=1010)
  4: 98.07%  (n=982)
  5: 98.09%  (n=892)
  6: 98.64%  (n=958)
  7: 97.96%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  4 -> 9: 9
  7 -> 2: 7
  5 -> 3: 7
  7 -> 9: 6
  9 -> 4: 5
  8 -> 9: 5
  3 -> 9: 5
  7 -> 8: 4
  6 -> 1: 4
  4 -> 6: 4
Stage: Fine-tune epoch 47/100 loss=0.000054
 Test accuracy: 98.63%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.57%  (n=982)
  5: 98.09%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.67%  (n=974)
  9: 97.92%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 8: 5
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  4 -> 9: 5
  6 -> 1: 4
  5 -> 9: 4
  4 -> 6: 4
Stage: Fine-tune epoch 48/100 loss=0.000019
 Test accuracy: 98.63%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.57%  (n=982)
  5: 98.09%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 97.92%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 8: 5
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  4 -> 9: 5
  6 -> 1: 4
  5 -> 9: 4
  4 -> 6: 4
Stage: Fine-tune epoch 49/100 loss=0.000015
 Test accuracy: 98.66%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.84%  (n=1032)
  3: 99.01%  (n=1010)
  4: 98.68%  (n=982)
  5: 97.98%  (n=892)
  6: 98.75%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.67%  (n=974)
  9: 97.92%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 8: 5
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  6 -> 1: 4
  5 -> 9: 4
  4 -> 9: 4
  4 -> 6: 4
Stage: Fine-tune epoch 50/100 loss=0.000012
 Test accuracy: 98.65%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.84%  (n=1032)
  3: 99.01%  (n=1010)
  4: 98.68%  (n=982)
  5: 97.98%  (n=892)
  6: 98.75%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 97.92%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 8: 5
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  6 -> 1: 4
  5 -> 9: 4
  4 -> 9: 4
  4 -> 6: 4
Stage: Fine-tune epoch 51/100 loss=0.000010
 Test accuracy: 98.64%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.68%  (n=982)
  5: 97.98%  (n=892)
  6: 98.75%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 97.92%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 8: 5
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  6 -> 1: 4
  5 -> 9: 4
  4 -> 9: 4
  4 -> 6: 4
Stage: Fine-tune epoch 52/100 loss=0.000008
 Test accuracy: 98.66%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.68%  (n=982)
  5: 97.98%  (n=892)
  6: 98.85%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 97.92%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 8: 5
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  5 -> 9: 4
  4 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 53/100 loss=0.000007
 Test accuracy: 98.66%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.68%  (n=982)
  5: 97.98%  (n=892)
  6: 98.85%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 97.92%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 8: 5
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  5 -> 9: 4
  4 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 54/100 loss=0.000006
 Test accuracy: 98.66%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.68%  (n=982)
  5: 97.98%  (n=892)
  6: 98.85%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 97.92%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 8: 5
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  5 -> 9: 4
  4 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 55/100 loss=0.000005
 Test accuracy: 98.66%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.68%  (n=982)
  5: 97.98%  (n=892)
  6: 98.85%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 97.92%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 8: 5
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  5 -> 9: 4
  4 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 56/100 loss=0.000005
 Test accuracy: 98.67%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.09%  (n=892)
  6: 98.85%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 97.92%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 8: 5
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  5 -> 9: 4
  4 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 57/100 loss=0.000004
 Test accuracy: 98.67%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.09%  (n=892)
  6: 98.85%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 97.92%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 8: 5
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  5 -> 9: 4
  4 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 58/100 loss=0.000004
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.09%  (n=892)
  6: 98.85%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.02%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  9 -> 8: 4
  5 -> 9: 4
  4 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 59/100 loss=0.000003
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.09%  (n=892)
  6: 98.85%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.02%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  9 -> 8: 4
  5 -> 9: 4
  4 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 60/100 loss=0.000003
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.09%  (n=892)
  6: 98.85%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.02%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  9 -> 8: 4
  5 -> 9: 4
  4 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 61/100 loss=0.000002
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.09%  (n=892)
  6: 98.85%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.02%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  9 -> 8: 4
  5 -> 9: 4
  4 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 62/100 loss=0.000002
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.78%  (n=982)
  5: 98.09%  (n=892)
  6: 98.85%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.02%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  9 -> 8: 4
  5 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
  7 -> 8: 3
Stage: Fine-tune epoch 63/100 loss=0.000002
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.29%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.78%  (n=982)
  5: 98.09%  (n=892)
  6: 98.85%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.02%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  9 -> 8: 4
  5 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
  7 -> 8: 3
Stage: Fine-tune epoch 64/100 loss=0.000002
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.78%  (n=982)
  5: 98.09%  (n=892)
  6: 98.85%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.02%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  9 -> 8: 4
  5 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
  7 -> 8: 3
Stage: Fine-tune epoch 65/100 loss=0.000001
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.78%  (n=982)
  5: 98.09%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.02%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  9 -> 8: 4
  6 -> 0: 4
  5 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 66/100 loss=0.000001
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.78%  (n=982)
  5: 98.09%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.02%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  9 -> 8: 4
  6 -> 0: 4
  5 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 67/100 loss=0.000001
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.78%  (n=982)
  5: 98.09%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.02%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  9 -> 8: 4
  6 -> 0: 4
  5 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 68/100 loss=0.000001
 Test accuracy: 98.67%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.78%  (n=982)
  5: 98.09%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.46%  (n=974)
  9: 98.02%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  9 -> 8: 4
  6 -> 0: 4
  5 -> 9: 4
  4 -> 6: 4
  9 -> 3: 3
Stage: Fine-tune epoch 69/100 loss=0.000001
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.78%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.46%  (n=974)
  9: 98.02%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  9 -> 8: 4
  6 -> 0: 4
  4 -> 6: 4
  9 -> 3: 3
  8 -> 3: 3
Stage: Fine-tune epoch 70/100 loss=0.000001
 Test accuracy: 98.67%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.46%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  6 -> 0: 4
  4 -> 9: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
Stage: Fine-tune epoch 71/100 loss=0.000001
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  6 -> 0: 4
  4 -> 9: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
Stage: Fine-tune epoch 72/100 loss=0.000001
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.84%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  6 -> 0: 4
  4 -> 9: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
Stage: Fine-tune epoch 73/100 loss=0.000001
 Test accuracy: 98.67%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  6 -> 0: 4
  4 -> 9: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
Stage: Fine-tune epoch 74/100 loss=0.000000
 Test accuracy: 98.70%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 75/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 76/100 loss=0.000000
 Test accuracy: 98.70%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 77/100 loss=0.000000
 Test accuracy: 98.70%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 78/100 loss=0.000000
 Test accuracy: 98.70%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.78%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.15%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  7 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 79/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 80/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 81/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 82/100 loss=0.000000
 Test accuracy: 98.70%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.30%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 83/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 84/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 85/100 loss=0.000000
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.78%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 86/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 87/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 88/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 89/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 90/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 91/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.91%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 92/100 loss=0.000000
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.21%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 93/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.32%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 94/100 loss=0.000000
 Test accuracy: 98.69%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.88%  (n=982)
  5: 98.32%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 95/100 loss=0.000000
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.78%  (n=982)
  5: 98.32%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
  9 -> 3: 3
Stage: Fine-tune epoch 96/100 loss=0.000000
 Test accuracy: 98.67%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.32%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 9: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
Stage: Fine-tune epoch 97/100 loss=0.000000
 Test accuracy: 98.67%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.32%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.12%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 9: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 8: 3
Stage: Fine-tune epoch 98/100 loss=0.000000
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.32%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.22%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 9: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 3: 3
Stage: Fine-tune epoch 99/100 loss=0.000000
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.32%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.22%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 9: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 3: 3
Stage: Fine-tune epoch 100/100 loss=0.000000
 Test accuracy: 98.68%
Per-class accuracy:
  0: 99.39%  (n=980)
  1: 99.21%  (n=1135)
  2: 98.74%  (n=1032)
  3: 98.81%  (n=1010)
  4: 98.68%  (n=982)
  5: 98.32%  (n=892)
  6: 98.75%  (n=958)
  7: 98.05%  (n=1028)
  8: 98.56%  (n=974)
  9: 98.22%  (n=1009)
Top confusions (true -> predicted counts):
  7 -> 2: 7
  7 -> 9: 6
  5 -> 3: 6
  9 -> 4: 5
  8 -> 9: 5
  6 -> 0: 4
  4 -> 9: 4
  4 -> 6: 4
  3 -> 2: 4
  9 -> 3: 3
Model saved to D:\Code\Github\Other\Python\DBN手写数字识别\model\dbn_mnist.pth
Accuracy plot saved to D:\Code\Github\Other\Python\DBN手写数字识别\model\accuracy_20251204_164853.png
Per-class accuracy plot saved to D:\Code\Github\Other\Python\DBN手写数字识别\model\per_class_accuracy_20251204_164853.png
Per-class history CSV saved to D:\Code\Github\Other\Python\DBN手写数字识别\model\per_class_history_20251204_164853.csv
